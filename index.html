<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互動式布達佩斯行程規劃</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The application is designed as a single-page dashboard with a tabbed navigation system. This structure was chosen over a linear report format to provide a superior user experience for trip planning. It logically separates different categories of information (Daily Plan, Essentials, Food, Overview) into easily accessible sections. Users can quickly navigate to the information they need without extensive scrolling. The daily itinerary uses a secondary tab system, allowing users to focus on one day at a time, which prevents information overload and aligns with the step-by-step nature of following a travel plan. This interactive, non-linear structure makes the information more digestible and user-friendly. -->
    <!-- Visualization & Content Choices: 
        1. Report Info: Distribution of planned activities (sightseeing, food, culture, relaxation). -> Goal: Inform/Summarize. -> Viz/Presentation Method: Donut Chart. -> Interaction: Hover for tooltips showing activity type and percentage. -> Justification: Provides a quick, visual overview of the trip's character and balance. -> Library/Method: Chart.js (Canvas).
        2. Report Info: Multi-day itinerary details. -> Goal: Organize/Inform. -> Viz/Presentation Method: A primary tabbed navigation for main sections and a secondary tabbed interface for daily plans. Each event is a card with an icon. -> Interaction: Click tabs to switch between sections and days. -> Justification: Breaks down a large amount of information into manageable, context-specific chunks, preventing user overwhelm and improving navigability. -> Library/Method: Vanilla JS for tab functionality, HTML/Tailwind for card structure.
        3. Report Info: Practical travel advice (transport, currency, tips). -> Goal: Inform/Organize. -> Viz/Presentation Method: A dedicated "Trip Essentials" section with collapsible accordion-style panels. -> Interaction: Click headers to expand/collapse detailed information. -> Justification: Keeps the UI clean by hiding dense text by default, while making crucial information readily available on demand. -> Library/Method: Vanilla JS for accordion functionality.
        4. Report Info: List of must-try foods. -> Goal: Inform/Tempt. -> Viz/Presentation Method: A grid of visually appealing cards, each representing a dish with a description. -> Interaction: Static display. -> Justification: Presents culinary recommendations in an engaging, easy-to-scan format. -> Library/Method: HTML/Tailwind.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-button.active {
            color: #C1A57B;
            border-bottom-color: #C1A57B;
        }
        .nav-button:hover {
            color: #A4895D;
        }
        .day-tab.active {
            background-color: #C1A57B;
            color: #FFFFFF;
        }
        .day-tab:not(.active) {
            background-color: #EAE3D9;
            color: #707070;
        }
        .day-tab {
            transition: all 0.3s ease;
        }
        .content-card {
            background-color: #FFFFFF;
            border-left: 4px solid #D6C6AC;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .content-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 400px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) { 
            .chart-container { 
                height: 350px; 
            } 
        }
    </style>
</head>
<body class="antialiased">

    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex items-center justify-between">
                    <h1 class="text-2xl md:text-3xl font-bold text-[#C1A57B]">您的互動式布達佩斯旅程</h1>
                    <div class="hidden md:block text-sm text-gray-500">
                        <p>6月25日 - 6月29日</p>
                        <p>住宿：國家歌劇院附近</p>
                    </div>
                </div>
            </div>
            <!-- Navigation -->
            <nav class="bg-[#F8F4EF]">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-center space-x-4 sm:space-x-8">
                        <button class="nav-button active py-3 px-2 text-sm sm:text-base font-medium" data-tab="overview">行程總覽</button>
                        <button class="nav-button py-3 px-2 text-sm sm:text-base font-medium" data-tab="daily">每日計畫</button>
                        <button class="nav-button py-3 px-2 text-sm sm:text-base font-medium" data-tab="attractions">景點介紹</button>
                        <button class="nav-button py-3 px-2 text-sm sm:text-base font-medium" data-tab="essentials">旅行必備</button>
                        <button class="nav-button py-3 px-2 text-sm sm:text-base font-medium" data-tab="food">美食地圖</button>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-2xl font-bold text-[#4A4A4A] mb-4">歡迎來到布達佩斯！</h2>
                    <p class="text-gray-600 mb-6">
                        這份行程專為您量身打造，旨在提供一場高效、悠閒且深入的布達佩斯之旅。我們將根據您的偏好，避開人潮，探索這座「東歐巴黎」的經典與秘境。行程圍繞您在國家歌劇院附近的住宿進行優化，減少不必要的奔波，讓您能以最輕鬆的步調，沉浸在多瑙河畔的歷史、藝術與美食之中。
                    </p>
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                        <div>
                            <h3 class="text-xl font-semibold text-[#4A4A4A] mb-3">旅程活動一覽</h3>
                            <p class="text-gray-600 mb-4">此圖表為您展示了本次旅程中各類活動的佔比，幫助您快速了解行程的整體風格。您可以看到我們在歷史探索、美食體驗與休閒放鬆之間取得了完美的平衡。</p>
                            <ul class="text-sm text-gray-500 space-y-1">
                                <li>🏛️ **歷史文化**: 深入探索城堡山、猶太區等世界遺產。</li>
                                <li>🍽️ **美食市場**: 品嚐地道匈牙利菜，體驗當地市場活力。</li>
                                <li>✨ **特色景點**: 探訪「最美的」咖啡館、圖書館與麥當勞。</li>
                                <li>🛶 **休閒放鬆**: 享受多瑙河遊船與賽切尼溫泉的愜意時光。</li>
                            </ul>
                        </div>
                        <div class="chart-container">
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Plan Tab -->
            <div id="daily" class="tab-content hidden">
                <!-- Day Tabs -->
                <div class="flex flex-wrap justify-center gap-2 mb-6">
                    <button class="day-tab active text-sm sm:text-base font-medium py-2 px-4 rounded-full" data-day="day1">第一天</button>
                    <button class="day-tab text-sm sm:text-base font-medium py-2 px-4 rounded-full" data-day="day2">第二天</button>
                    <button class="day-tab text-sm sm:text-base font-medium py-2 px-4 rounded-full" data-day="day3">第三天</button>
                    <button class="day-tab text-sm sm:text-base font-medium py-2 px-4 rounded-full" data-day="day4">第四天</button>
                    <button class="day-tab text-sm sm:text-base font-medium py-2 px-4 rounded-full" data-day="day5">第五天</button>
                </div>

                <!-- Day 1 Content -->
                <div id="day1" class="day-content space-y-6">
                    <h3 class="text-xl font-bold text-center text-gray-700">6月25日 (星期三): 抵達與佩斯初體驗</h3>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🛬 下午: 機場接駁 & 飯店入住</h4>
                        <p class="text-gray-600">下午2:20抵達機場，預計下午4:00左右抵達位於國家歌劇院附近的飯店。建議搭乘Bolt叫車或預約機場接駁，以獲得最舒適便捷的抵達體驗，為旅程儲備體力。</p>
                    </div>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🌙 傍晚/夜晚: 安頓與多瑙河畔漫步</h4>
                        <p class="text-gray-600">安頓好後，在飯店附近享用輕鬆的晚餐。隨後，悠閒地散步至多瑙河畔，初步領略燈火通明的鏈橋與對岸雄偉的布達城堡，感受布達佩斯寧靜而壯麗的夜色，為您的旅程揭開序幕。</p>
                    </div>
                    <div class="text-center mt-6">
                        <a href="https://www.google.com/maps/search/?api=1&query=Budapest+Airport,+Hungarian+State+Opera,+Danube+River+Budapest" target="_blank" class="inline-block bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300">查看地圖</a>
                    </div>
                </div>

                <!-- Day 2 Content -->
                <div id="day2" class="day-content hidden space-y-6">
                     <h3 class="text-xl font-bold text-center text-gray-700">6月26日 (星期四): 市場風情與猶太區探索</h3>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🛍️ 上午 (清晨): 市場巡禮</h4>
                        <p class="text-gray-600 mb-3"><strong>第一站：拉科齊市場大廳 (Rákóczi Market Hall)</strong><br>從這個更具地方色彩的市場開始，體驗最道地的匈牙利日常生活。建議上午8-9點抵達，感受市場甦醒時的活力，又可避開第一波購物人潮。</p>
                        <p class="text-gray-600"><strong>第二站：中央市場大廳 (Great Market Hall)</strong><br>接著前往布達佩斯最大、最著名的室內市場。建議上午10點後抵達，此時當地人購物高峰已過，您可以更悠閒地探索琳瑯滿目的商品，並在樓上品嚐蘭戈斯 (Langos) 等地道小吃作為午餐。</p>
                    </div>
                     <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🕍 下午: 猶太區深度遊</h4>
                        <p class="text-gray-600">參觀歐洲最大的猶太教堂——**多哈尼街煙草會堂** (Dohány Street Synagogue)。建議參加導覽，深入了解其背後的歷史故事。之後，漫步於充滿活力的猶太區，感受其獨特的歷史氛圍、特色小店與廢墟酒吧文化。晚餐可在此區選擇一家餐廳，品嚐正宗的匈牙利燉牛肉。</p>
                        <p class="text-xs text-gray-500 mt-2"><strong>訣竅：</strong>煙草會堂在下午時段人潮較少，可獲得更好的參觀體驗。</p>
                    </div>
                    <div class="text-center mt-6">
                        <a href="https://www.google.com/maps/search/?api=1&query=Rákóczi+Market+Hall,+Great+Market+Hall,+Dohány+Street+Synagogue+Budapest" target="_blank" class="inline-block bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300">查看地圖</a>
                    </div>
                </div>
                
                <!-- Day 3 Content - Added 'hidden' class -->
                <div id="day3" class="day-content hidden space-y-6">
                    <h3 class="text-xl font-bold text-center text-gray-700">6月27日 (星期五): 布達皇城、溫泉與多瑙河之戀</h3>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🏰 上午: 布達城堡山探索</h4>
                        <p class="text-gray-600">提早出發，搭乘纜車登上城堡山，避開人潮。依序參觀**馬提亞斯教堂**的華麗內飾與彩色屋頂，接著到**漁夫堡**，這裡是拍攝國會大廈全景的最佳地點。最後，在外圍欣賞宏偉的**布達皇宮**，感受昔日帝國的輝煌。</p>
                    </div>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🛁 下午: 賽切尼溫泉 (Széchenyi Thermal Bath)</h4>
                        <p class="text-gray-600">前往歐洲最大的溫泉浴場之一，體驗布達佩斯獨特的溫泉文化。您可以在巨大的戶外溫泉池中放鬆身心，洗去旅途的疲憊。</p>
                        <p class="text-xs text-gray-500 mt-2"><strong>訣竅：</strong>建議下午5:30後入場，此時人潮開始散去，您可以享受更寧靜的氛圍，並體驗從白天到夜晚的溫泉景色。</p>
                    </div>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🛶 傍晚: 日落黃昏遊船</h4>
                        <p class="text-gray-600">這是您此行的亮點！6月27日的日落時間約為晚上8:45。建議預訂**晚上8:15至8:20出發的遊船**，這樣可以完整捕捉從日落餘暉到華燈初上的魔幻時刻。看著國會大廈與兩岸建築在夜色中被點亮，倒映在多瑙河上，將是畢生難忘的畫面。</p>
                        <p class="text-xs text-gray-500 mt-2"><strong>訣竅：</strong>務必提前預訂船票，尤其是在週五晚上。</p>
                    </div>
                    <div class="text-center mt-6">
                        <a href="https://www.google.com/maps/search/?api=1&query=Matthias+Church,+Fisherman%27s+Bastion,+Buda+Castle,+St.+Stephen%27s+Basilica,+Danube+River+cruise+Budapest" target="_blank" class="inline-block bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300">查看地圖</a>
                    </div>
                </div>

                <!-- Day 4 Content - Added 'hidden' class -->
                <div id="day4" class="day-content hidden space-y-6">
                    <h3 class="text-xl font-bold text-center text-gray-700">6月28日 (星期六): 佩斯風華與文學魅力</h3>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">☕ 上午: 尋訪「最美的」景點</h4>
                         <p class="text-gray-600 mb-3"><strong>第一站: 紐約咖啡館 (New York Café)</strong><br>務必在早上8點開門時抵達，以避開長長的隊伍，進入這座被譽為「世界最美咖啡館」的宮殿，享用一頓華麗的早餐或咖啡。</p>
                        <p class="text-gray-600"><strong>第二站: 薩博·埃爾文中央圖書館 (Metropolitan Ervin Szabó Library)</strong><br>探訪這座隱藏在現代圖書館內的「最美圖書館」，其四樓的巴洛克風格閱覽室絕對會讓您嘆為觀止。</p>
                    </div>
                     <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🏛️ 下午: 安德拉什大街漫步與國家歌劇院</h4>
                        <p class="text-gray-600">在被列為世界遺產的安德拉什大街上悠閒漫步，欣賞兩旁的新文藝復興建築，逛逛精品店。您可以參加**國家歌劇院**的導覽，深入了解這座建築瑰寶。</p>
                    </div>
                     <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🍔 晚餐: 最美的麥當勞</h4>
                        <p class="text-gray-600">前往位於紐加提火車站 (Nyugati Railway Station) 的「最美麥當勞」作為晚餐或宵夜。這家麥當勞開在由艾菲爾鐵塔設計團隊建造的歷史建築內，用餐環境極具特色，為一天的行程畫上奇趣的句點。</p>
                    </div>
                    <div class="text-center mt-6">
                        <a href="https://www.google.com/maps/search/?api=1&query=New+York+Café+Budapest,+Metropolitan+Ervin+Szabó+Library,+Hungarian+State+Opera,+Széchenyi+Thermal+Bath,+McDonald%27s+Nyugati+Railway+Station" target="_blank" class="inline-block bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300">查看地圖</a>
                    </div>
                </div>

                <!-- Day 5 Content - Added 'hidden' class -->
                <div id="day5" class="day-content hidden space-y-6">
                    <h3 class="text-xl font-bold text-center text-gray-700">6月29日 (星期日): 輕鬆告別</h3>
                    <div class="content-card rounded-lg shadow-sm p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">🚆 上午: 前往布拉格</h4>
                        <p class="text-gray-600">早上在飯店附近享用最後一頓早餐。您的火車將於上午7:45從**德利火車站 (Déli Railway Station)** 出發。考慮到是清晨且需攜帶行李，強烈建議預訂計程車或使用Bolt叫車服務，確保最遲在上午7:15前抵達車站，輕鬆無壓力地開啟下一段旅程。</p>
                    </div>
                    <div class="text-center mt-6">
                        <a href="https://www.google.com/maps/search/?api=1&query=Déli+Railway+Station+Budapest" target="_blank" class="inline-block bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300">查看地圖</a>
                    </div>
                </div>
            </div>

            <!-- Attractions Tab (New Section) -->
            <div id="attractions" class="tab-content hidden">
                <h2 class="text-2xl font-bold text-[#4A4A4A] mb-6 text-center">布達佩斯景點介紹</h2>
                <div class="space-y-4">
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>鏈橋 (Chain Bridge)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">鏈橋是布達佩斯最古老、最著名的橋樑，連接了布達和佩斯兩岸。它不僅是交通要道，更是布達佩斯的地標之一，尤其在夜晚燈火通明時，景色更為迷人。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>布達城堡 (Buda Castle)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">布達城堡是匈牙利國王們的歷史居所，被列為聯合國教科文組織世界遺產。它坐落在城堡山上，俯瞰多瑙河，包含馬提亞斯教堂、漁夫堡和皇宮等重要建築，是了解匈牙利歷史和欣賞城市全景的絕佳地點。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>拉科齊市場大廳 (Rákóczi Market Hall)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">這個歷史悠久的市場大廳提供了更道地的匈牙利日常生活體驗，您可以在這裡找到當地農產品、肉類和傳統美食，感受布達佩斯居民的日常脈動。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>中央市場大廳 (Great Market Hall)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">布達佩斯最大、最著名的室內市場，樓高三層，販售各種匈牙利特色商品，從新鮮蔬果、肉類、香料到紀念品應有盡有。您還可以在樓上品嚐到蘭戈斯等當地小吃。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>多哈尼街煙草會堂 (Dohány Street Synagogue)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">歐洲最大的猶太教堂，也是布達佩斯猶太社區的中心。其宏偉的建築和豐富的歷史使其成為一個重要的文化和歷史地標，值得深入了解。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>馬提亞斯教堂 (Matthias Church)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">位於布達城堡區內，這座哥德式教堂以其華麗的內部裝飾和獨特的彩色瓦片屋頂而聞名。它是匈牙利國王加冕和舉行皇室婚禮的重要場所。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>漁夫堡 (Fishermen's Bastion)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">緊鄰馬提亞斯教堂，漁夫堡是一座新羅馬式和新哥德式風格的觀景台。它提供了布達佩斯最壯麗的國會大廈、多瑙河和佩斯全景，是拍照的絕佳地點。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>聖伊什特萬聖殿圓頂 (St. Stephen's Basilica Dome)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">這座宏偉的羅馬天主教堂是布達佩斯最大的教堂之一，其圓頂觀景台提供了市中心360度的全景視野，是俯瞰佩斯天際線的絕佳地點。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>紐約咖啡館 (New York Café)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">被譽為「世界最美咖啡館」，這座富麗堂皇的咖啡館擁有令人驚嘆的巴洛克式裝潢，是品嚐咖啡、早餐或甜點的奢華體驗，彷彿置身於藝術殿堂。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>薩博·埃爾文中央圖書館 (Metropolitan Ervin Szabó Library)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">這座圖書館內隱藏著一座令人驚嘆的巴洛克風格閱覽室，被譽為「最美圖書館」。它提供了一個獨特而寧靜的文化體驗。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>匈牙利國家歌劇院 (Hungarian National Opera House)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">這座新文藝復興風格的宏偉建築是布達佩斯最美麗的建築之一，也是世界級的歌劇院。您可以參加導覽，深入了解其歷史和建築藝術。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>賽切尼溫泉 (Széchenyi Thermal Bath)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">歐洲最大的藥用溫泉浴場之一，擁有室內外多個溫泉池。在這裡您可以體驗布達佩斯獨特的溫泉文化，放鬆身心，洗去旅途的疲憊。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>紐加提麥當勞 (Nyugati Railway Station McDonald's)</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">位於紐加提火車站內，這家麥當勞被譽為「世界最美麥當勞」之一，其建築由艾菲爾鐵塔設計團隊建造，用餐環境獨具特色，是個有趣的打卡點。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Essentials Tab -->
            <div id="essentials" class="tab-content hidden">
                <div class="space-y-4">
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>公共交通與通行證</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600 mb-2">布達佩斯公共交通系統高效便捷。為避免每次購票和驗票的麻煩，強烈推薦購買多日通行證。</p>
                            <p class="text-gray-600 mb-2"><strong>推薦選項：</strong> 72小時通行證 (5,500 HUF) 或 7天通行證 (4,600 HUF) 是您4天完整行程的最佳選擇，提供無限次搭乘且無需驗票，性價比極高。</p>
                            <p class="font-bold text-red-600"><strong>⚠️ 重要提示：</strong>若購買單程票，上車或進站時「必須」驗票，否則將面臨高額罰款！</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>貨幣、支付與小費</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                         <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600 mb-2"><strong>貨幣：</strong>匈牙利福林 (HUF)。建議在市區的兌換處或ATM取款，避免在機場兌換。</p>
                            <p class="text-gray-600 mb-2"><strong>支付：</strong>信用卡被廣泛接受，但建議隨身攜帶一些匈牙利福林現金，以備小額購物、當地市場或街頭小吃攤之需。</p>
                            <p class="text-gray-600"><strong>小費：</strong>餐廳小費約為10%。付款前請檢查帳單是否已包含服務費 (szervizdíj)。</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>計程車與叫車服務</span>
                             <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600">Uber在匈牙利不營運。請使用官方計程車或下載 **Bolt** 應用程式。務必選擇正規服務，避免搭乘路邊招攬的無牌計程車，以防被敲竹槓。</p>
                        </div>
                    </div>
                    <!-- Hungarian phrases section -->
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>匈牙利語日常對話</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600 mb-2">學習幾句簡單的匈牙利語，能讓您的旅程更加順暢愉快！</p>
                            <ul class="space-y-2">
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>你好 (Hello):</strong> Szia (非正式) / Jó napot (正式)</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Szia. Jó napot." data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>謝謝 (Thank you):</strong> Köszönöm</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Köszönöm" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>請 (Please):</strong> Kérem</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Kérem" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>對不起 (Sorry):</strong> Elnézést</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Elnézést" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>是 (Yes):</strong> Igen</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Igen" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>否 (No):</strong> Nem</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Nem" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>多少錢？ (How much?):</strong> Mennyibe kerül?</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Mennyibe kerül?" data-lang="hu-HU">播放發音</button>
                                </li>
                                <li class="flex items-center justify-between">
                                    <span class="text-gray-700"><strong>再見 (Goodbye):</strong> Viszlát</span>
                                    <button class="play-pronunciation-btn bg-[#D6C6AC] text-white text-sm font-medium py-1 px-3 rounded-full hover:bg-[#C1A57B] transition duration-300" data-phrase="Viszlát" data-lang="hu-HU">播放發音</button>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- New section for Recommended Souvenirs -->
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>推薦紀念品</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600 mb-2">為親朋好友帶回獨特的匈牙利紀念品，分享旅途的喜悅！</p>
                            <ul class="space-y-2 text-gray-700">
                                <li><strong>紅椒粉 (Paprika):</strong> 匈牙利的「紅金」，是當地料理的靈魂。可以選擇甜味或辣味的紅椒粉，包裝精美，非常適合送禮。</li>
                                <li><strong>匈牙利葡萄酒 (Hungarian Wine):</strong> 尤其是托卡伊貴腐酒 (Tokaji Aszú)，被譽為「王者之酒，酒中之王」，是世界頂級的甜酒，非常珍貴。</li>
                                <li><strong>鵝肝醬 (Libamáj):</strong> 匈牙利是鵝肝的主要生產國之一，其鵝肝醬品質優良，是美食愛好者的絕佳選擇。</li>
                                <li><strong>手工刺繡品 (Hungarian Embroidery):</strong> 匈牙利傳統刺繡色彩鮮豔，圖案精美，如卡洛喬 (Kalocsa) 或馬特約 (Matyó) 刺繡，可作為裝飾品或服飾配件。</li>
                                <li><strong>魯比克方塊 (Rubik's Cube):</strong> 雖然現在全球都有，但魯比克方塊是由匈牙利發明的，帶一個原產地紀念品也很有趣。</li>
                                <li><strong>伊卡瓷器 (Herend Porcelain):</strong> 如果預算充足，伊卡瓷器是世界聞名的手工瓷器品牌，設計精緻，極具收藏價值。</li>
                                <li><strong>匈牙利蜂蜜 (Hungarian Honey):</strong> 匈牙利出產高品質的蜂蜜，尤其是有機蜂蜜和特殊花種蜂蜜。</li>
                                <li><strong>匈牙利香腸與臘肉 (Hungarian Sausage & Salami):</strong> 許多市場都有販售當地特色的香腸和臘肉，風味獨特，但需注意入境台灣的相關規定。</li>
                            </ul>
                        </div>
                    </div>
                    <!-- New section for LLM-powered cultural questions -->
                    <div class="bg-white rounded-lg shadow-md">
                        <button class="accordion-toggle flex justify-between items-center w-full p-4 font-semibold text-left">
                            <span>當地文化問答 ✨</span>
                            <span class="transform transition-transform duration-300">▼</span>
                        </button>
                        <div class="accordion-content px-4 pb-4">
                            <p class="text-gray-600 mb-2">有任何關於匈牙利文化、習俗或旅行建議的問題嗎？請在這裡提問！</p>
                            <textarea id="cultureQuestion" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#C1A57B] mb-3 resize-y" rows="3" placeholder="例如：匈牙利人有哪些特別的用餐禮儀？"></textarea>
                            <button id="askCultureQuestionBtn" class="w-full bg-[#C1A57B] text-white font-bold py-2 px-4 rounded-full hover:bg-[#A4895D] transition duration-300 flex items-center justify-center">
                                <span id="buttonText">詢問文化知識 ✨</span>
                                <svg id="loadingSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                            </button>
                            <div id="cultureAnswer" class="mt-4 p-4 bg-[#F8F4EF] rounded-md text-gray-700 hidden"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Food Tab -->
            <div id="food" class="tab-content hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">匈牙利牛肉湯 (Gulyásleves)</h4>
                        <p class="text-gray-600">國菜代表！由牛肉、蔬菜和大量紅椒粉燉煮而成，濃郁暖心，通常作為主菜。推薦店家：Pest-Buda Bistro。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">蘭戈斯 (Lángos)</h4>
                        <p class="text-gray-600">最受歡迎的街頭小吃。現炸的麵餅，外酥內軟，經典口味是抹上蒜蓉、酸奶油和滿滿的起司。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">煙囪捲 (Kürtőskalács)</h4>
                        <p class="text-gray-600">新鮮烘烤的螺旋狀甜麵包，外層裹著焦糖和核桃、肉桂等配料，香氣逼人，人手一支的散步甜點。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">紅椒雞 (Csirkepaprikás)</h4>
                        <p class="text-gray-600">另一道經典匈牙利家常菜。雞肉在香甜的紅椒粉醬汁中燉煮，口感嫩滑，通常搭配一種名為 nokedli 的麵疙瘩。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">多博什蛋糕 (Dobos Torta)</h4>
                        <p class="text-gray-600">精緻的匈牙利甜點。由多層海綿蛋糕和巧克力奶油堆疊而成，頂部覆蓋著一層脆脆的焦糖片。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h4 class="font-bold text-lg text-[#C1A57B] mb-2">酸櫻桃冷湯 (Hideg Meggyleves)</h4>
                        <p class="text-gray-600">一道獨特的夏季湯品。冰涼的酸櫻桃湯，甜中帶酸，清爽開胃，在炎熱的六月天品嚐再合適不過。</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navButtons = document.querySelectorAll('.nav-button');
            const tabContents = document.querySelectorAll('.tab-content');
            const dayTabs = document.querySelectorAll('.day-tab');
            const dayContents = document.querySelectorAll('.day-content');
            const accordions = document.querySelectorAll('.accordion-toggle');
            const pronunciationButtons = document.querySelectorAll('.play-pronunciation-btn');

            function showTab(tabId, buttons, contents) {
                buttons.forEach(button => {
                    button.classList.remove('active');
                });
                contents.forEach(content => {
                    content.classList.add('hidden');
                });

                const activeButton = document.querySelector(`[data-tab="${tabId}"]`) || document.querySelector(`[data-day="${tabId}"]`);
                const activeContent = document.getElementById(tabId);
                
                if(activeButton) activeButton.classList.add('active');
                if(activeContent) activeContent.classList.remove('hidden');
            }

            // Initially show the overview tab
            showTab('overview', navButtons, tabContents);

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;
                    showTab(tabId, navButtons, tabContents);
                });
            });

            dayTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const dayId = tab.dataset.day;
                    showTab(dayId, dayTabs, dayContents);
                });
            });
            
            // Re-select accordions after DOM content is loaded, including new ones
            document.querySelectorAll('.accordion-toggle').forEach(accordion => {
                accordion.addEventListener('click', () => {
                    const content = accordion.nextElementSibling;
                    const icon = accordion.querySelector('span:last-child');
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        icon.style.transform = 'rotate(0deg)';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.style.transform = 'rotate(180deg)';
                    }
                });
            });

            // Speech Synthesis API for pronunciation
            if ('speechSynthesis' in window) {
                pronunciationButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const phrase = button.dataset.phrase;
                        const lang = button.dataset.lang || 'en-US'; // Default to English if no lang specified
                        
                        const utterance = new SpeechSynthesisUtterance(phrase);
                        utterance.lang = lang; // Set language for pronunciation

                        // Find a Hungarian voice if available
                        const voices = window.speechSynthesis.getVoices();
                        const hungarianVoice = voices.find(voice => voice.lang === 'hu-HU');
                        if (hungarianVoice) {
                            utterance.voice = hungarianVoice;
                        } else {
                            console.warn('未找到匈牙利語語音，將使用預設語音。'); // Warning if Hungarian voice not found
                        }

                        window.speechSynthesis.speak(utterance);

                        // Temporary visual feedback
                        button.textContent = '播放中...';
                        utterance.onend = () => {
                            button.textContent = '播放發音';
                        };
                        utterance.onerror = (event) => {
                            console.error('語音播放錯誤:', event.error);
                            button.textContent = '播放失敗';
                            setTimeout(() => {
                                button.textContent = '播放發音';
                            }, 1000);
                        };
                    });
                });
            } else {
                pronunciationButtons.forEach(button => {
                    button.disabled = true;
                    button.textContent = '不支援發音';
                });
                console.warn('您的瀏覽器不支援語音合成功能。');
            }


            const ctx = document.getElementById('activityChart').getContext('2d');
            const activityChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['🏛️ 歷史文化', '🍽️ 美食市場', '✨ 特色景點', '🛶 休閒放鬆'],
                    datasets: [{
                        label: '活動佔比',
                        data: [40, 20, 25, 15],
                        backgroundColor: [
                            '#C1A57B',
                            '#D6C6AC',
                            '#A4895D',
                            '#EAE3D9'
                        ],
                        borderColor: '#FDFBF8',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: "'Noto Sans TC', sans-serif",
                                    size: 14
                                },
                                color: '#4A4A4A',
                                boxWidth: 20,
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });

            // Gemini API Integration for Local Culture Q&A
            const askCultureQuestionBtn = document.getElementById('askCultureQuestionBtn');
            const cultureQuestionInput = document.getElementById('cultureQuestion');
            const cultureAnswerDiv = document.getElementById('cultureAnswer');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const buttonText = document.getElementById('buttonText');

            askCultureQuestionBtn.addEventListener('click', async () => {
                const prompt = cultureQuestionInput.value.trim();
                if (!prompt) {
                    cultureAnswerDiv.textContent = '請輸入您的問題！';
                    cultureAnswerDiv.classList.remove('hidden');
                    return;
                }

                buttonText.textContent = '思考中...';
                loadingSpinner.classList.remove('hidden');
                cultureAnswerDiv.classList.add('hidden'); // Hide previous answer
                cultureAnswerDiv.textContent = ''; // Clear previous answer

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: `想像你是一個布達佩斯知識淵博的當地導遊。用戶問道：${prompt}。請針對匈牙利文化、習俗或布達佩斯旅行建議提供簡潔且有幫助的回答。如果問題超出範圍或不明確，請溫和地引導他們回到主題。` }] });
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // Leave as-is for Canvas environment
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        cultureAnswerDiv.textContent = text;
                        cultureAnswerDiv.classList.remove('hidden');
                    } else {
                        cultureAnswerDiv.textContent = '抱歉，無法獲取回答。請稍後再試。';
                        cultureAnswerDiv.classList.remove('hidden');
                        console.error('LLM response structure unexpected:', result);
                    }
                } catch (error) {
                    cultureAnswerDiv.textContent = '發生錯誤，無法連接到服務。';
                    cultureAnswerDiv.classList.remove('hidden');
                    console.error('Error fetching LLM response:', error);
                } finally {
                    buttonText.textContent = '詢問文化知識 ✨';
                    loadingSpinner.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>
